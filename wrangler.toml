name = "send-signaling"
main = "worker.js"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

# Serve static files from public/ — Worker handles /ice and /ws,
# everything else falls through to the static asset handler.
[assets]
directory = "./public"
binding = "ASSETS"
run_worker_first = ["/ice", "/ws"]

# Durable Objects
[[durable_objects.bindings]]
name = "SIGNALING_ROOM"
class_name = "SignalingRoom"

[[durable_objects.bindings]]
name = "USAGE_GUARD"
class_name = "UsageGuard"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["SignalingRoom"]

[[migrations]]
tag = "v2"
new_sqlite_classes = ["UsageGuard"]

# Secrets (set via `npx wrangler secret put <NAME>`):
#   CF_TURN_KEY_ID       — Cloudflare Calls TURN key ID
#   CF_TURN_KEY_SECRET   — Cloudflare Calls TURN key secret
#   CF_ACCOUNT_ID        — Cloudflare account ID (for usage API)
#   CF_EMAIL             — Cloudflare account email (for usage API)
#   CF_GLOBAL_API_KEY    — Cloudflare Global API Key (for usage API)
